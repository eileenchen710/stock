import{r as a,j as e,c as X,m as x}from"./chunks/index-ClKf2CbM.js";import{G as Z}from"./chunks/GradientText-BvkcKc4C.js";import{B as L}from"./chunks/Button-zSFrK51C.js";import{I as O}from"./chunks/Input-GJFWVui3.js";import{A as R,T as ee,a as te,b as ae,c as p,d as se,e as y}from"./chunks/Table-CJsp_9j5.js";const $=a.forwardRef(({className:n="",variant:c="default",style:l,...h},j)=>{const g=c==="destructive"?"border-red-200 bg-red-50 text-red-900":"border-green-200 bg-green-50 text-green-900";return e.jsx("div",{ref:j,role:"alert",className:`relative w-full rounded-xl border text-sm flex items-start gap-3 shadow-lg ${g} ${n}`,style:{padding:"16px",...l},...h})});$.displayName="Alert";const E=a.forwardRef(({className:n="",...c},l)=>e.jsx("h5",{ref:l,className:`font-medium leading-none tracking-tight ${n}`,...c}));E.displayName="AlertTitle";const I=a.forwardRef(({className:n="",...c},l)=>e.jsx("div",{ref:l,className:`text-sm opacity-90 ${n}`,...c}));I.displayName="AlertDescription";const re={stock_order:"Stock Order",daily_order:"Daily Order",vor_order:"VOR Order"};function ne(){const n=window.dealerInventory||{products:[],cartUrl:"/cart/",nonce:"",ajaxUrl:"",addToCartNonce:"",searchNonce:""},[c,l]=a.useState([]),[h,j]=a.useState(""),[g,P]=a.useState({}),[S,B]=a.useState({}),[v,w]=a.useState(null),[T,k]=a.useState(!0),[N,C]=a.useState(!1),[D,U]=a.useState(1),[A,F]=a.useState(!1),[q,z]=a.useState(0),[H,_]=a.useState(!1),[d,u]=a.useState(null),b=a.useRef(null),f=a.useCallback(async(t,r,i=!1)=>{r===1&&!i?k(!0):C(!0);try{const s=new FormData;s.append("action","dealer_search_products"),s.append("nonce",n.searchNonce),s.append("search",t),s.append("page",String(r));const o=await(await fetch(n.ajaxUrl,{method:"POST",body:s})).json();o.success&&(l(i?J=>[...J,...o.data.products]:o.data.products),F(o.data.has_more),z(o.data.total),U(o.data.page))}catch(s){console.error("Failed to fetch products:",s)}finally{k(!1),C(!1),_(!1)}},[n.ajaxUrl,n.searchNonce]);a.useEffect(()=>{f("",1)},[f]);const G=t=>{j(t),_(!0),b.current&&clearTimeout(b.current),b.current=setTimeout(()=>{f(t,1)},300)},K=()=>{!N&&A&&f(h,D+1,!0)},Q=t=>t<=0?{text:"Out of Stock",className:"text-red-600"}:t<=10?{text:"Low Stock",className:"text-amber-600"}:{text:"In Stock",className:"text-green-600"},W=(t,r)=>{P(i=>({...i,[t]:r}))},V=(t,r)=>{B(i=>({...i,[t]:r}))},Y=async t=>{const r=g[t.id]||1,i=S[t.id]||"stock_order";w(t.id);try{const s=new FormData;s.append("action","dealer_add_to_cart"),s.append("nonce",n.addToCartNonce),s.append("product_id",String(t.id)),s.append("quantity",String(r)),s.append("order_type",i);const o=await(await fetch(n.ajaxUrl,{method:"POST",body:s})).json();o.success?(u({show:!0,product:t.name,quantity:r}),setTimeout(()=>u(null),3e3)):(console.error("Failed to add to cart:",o.data?.message),u({show:!0,product:t.name,quantity:r,error:!0,message:o.data?.message||"Unknown error"}),setTimeout(()=>u(null),4e3))}catch(s){console.error("Failed to add to cart:",s),u({show:!0,product:t.name,quantity:r,error:!0,message:"Network error"}),setTimeout(()=>u(null),4e3)}finally{w(null)}};return e.jsx("div",{className:"page-container",children:e.jsxs("div",{className:"page-content",children:[e.jsx(R,{children:d?.show&&e.jsx(x.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"fixed bottom-6 right-6 z-50 w-full max-w-sm",children:e.jsxs($,{variant:d.error?"destructive":"default",children:[d.error?e.jsx("svg",{className:"h-4 w-4 text-red-600 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}):e.jsx("svg",{className:"h-4 w-4 text-green-600 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{children:[e.jsx(E,{children:d.error?"Error":"Added to Cart"}),e.jsx(I,{children:d.error?d.message:`${d.quantity}x ${d.product}`})]})]})})}),e.jsxs(x.div,{className:"mb-8 text-center",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},children:[e.jsx("h1",{className:"text-4xl font-bold mb-2",children:e.jsx(Z,{animationSpeed:4,children:"Inventory"})}),e.jsx("p",{className:"text-gray-500",children:"Browse and order products"})]}),e.jsx(x.div,{className:"!mb-4 flex justify-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsx(O,{type:"text",placeholder:"Search by SKU or product name...",value:h,onChange:t=>G(t.target.value),className:"max-w-md w-full !rounded-full"})}),T?e.jsxs(x.div,{className:"text-center py-16",initial:{opacity:0},animate:{opacity:1},children:[e.jsx("div",{className:"inline-block w-8 h-8 border-2 border-gray-300 border-t-gray-900 rounded-full animate-spin mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Loading products..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(x.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white overflow-hidden",children:e.jsxs(ee,{children:[e.jsx(te,{children:e.jsxs(ae,{children:[e.jsx(p,{children:"SKU"}),e.jsx(p,{children:"Product"}),e.jsx(p,{className:"text-right",children:"Stock"}),e.jsx(p,{children:"Status"}),e.jsx(p,{children:"Type"}),e.jsx(p,{className:"text-right",children:"Order"})]})}),e.jsx(se,{children:e.jsx(R,{children:c.map((t,r)=>{const i=Q(t.stock),s=S[t.id]||"stock_order";return e.jsxs(x.tr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{delay:r*.02},className:"border-b border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx(y,{className:"font-mono text-gray-600",children:t.sku||"-"}),e.jsx(y,{className:"font-medium text-gray-900",children:t.name}),e.jsx(y,{className:"text-right text-gray-700",children:t.stock??"N/A"}),e.jsx(y,{children:e.jsx("span",{className:`font-medium ${i.className}`,children:i.text})}),e.jsx(y,{children:e.jsx("select",{value:s,onChange:m=>V(t.id,m.target.value),className:"h-10 px-3 py-2 text-sm border border-gray-200 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent",children:Object.entries(re).map(([m,o])=>e.jsx("option",{value:m,children:o},m))})}),e.jsx(y,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(O,{type:"number",min:1,value:g[t.id]||1,onChange:m=>W(t.id,parseInt(m.target.value)||1),className:"w-20 h-8 text-center"}),e.jsx(L,{size:"sm",onClick:()=>Y(t),disabled:v===t.id,children:v===t.id?"...":"Add"})]})})]},t.id)})})})]})}),c.length===0&&!T&&e.jsx(x.div,{className:"text-center py-12",initial:{opacity:0},animate:{opacity:1},children:e.jsx("p",{className:"text-gray-500",children:h?`No products found matching "${h}"`:"No products available"})}),e.jsxs(x.div,{className:"mt-6 text-center",initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},children:[A&&!h&&e.jsx(L,{onClick:K,disabled:N,className:"mb-4",children:N?"Loading...":"Load More"}),e.jsx("p",{className:"text-sm text-gray-400",children:H?"Searching...":`Showing ${c.length} of ${q} products`})]})]})]})})}const M=document.getElementById("dealer-inventory-root");M&&X.createRoot(M).render(e.jsx(a.StrictMode,{children:e.jsx(ne,{})}));
