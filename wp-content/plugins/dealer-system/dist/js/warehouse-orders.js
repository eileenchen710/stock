import{c as L,j as e,r,m as n}from"./chunks/index-ClKf2CbM.js";import{G as R}from"./chunks/GradientText-BvkcKc4C.js";import{B as U}from"./chunks/Button-zSFrK51C.js";import{I as M}from"./chunks/Input-GJFWVui3.js";import{T as P,a as $,b as z,c as l,d as W,e as d}from"./chunks/Table-LW9oDM4-.js";import{A as G,a as H,b as I}from"./chunks/Alert-B5GFDb8d.js";import{A as k}from"./chunks/index-CWUfAGMP.js";const V={pending:"background:#fef3c7;color:#d97706;",processing:"background:#dbeafe;color:#2563eb;","on-hold":"background:#ffedd5;color:#ea580c;",completed:"background:#dcfce7;color:#16a34a;",cancelled:"background:#fee2e2;color:#dc2626;",refunded:"background:#f3f4f6;color:#6b7280;",failed:"background:#fee2e2;color:#dc2626;"};function q(){const h=window.warehouseOrders||{ajaxUrl:"",nonce:"",updateNonce:"",orderDetailUrl:"/warehouse-order/"},[x,b]=r.useState([]),[w,_]=r.useState({}),[O,N]=r.useState(!0),[g,C]=r.useState(""),[f,F]=r.useState("all"),[A,v]=r.useState(null),[u,i]=r.useState(null),j=r.useRef(null),p=async(t="",o="all")=>{N(!0);try{const a=new FormData;a.append("action","warehouse_get_orders"),a.append("nonce",h.nonce),a.append("search",t),a.append("status",o);const s=await(await fetch(h.ajaxUrl,{method:"POST",body:a})).json();s.success&&(b(s.data.orders),_(s.data.statuses))}catch(a){console.error("Failed to fetch orders:",a)}finally{N(!1)}};r.useEffect(()=>{p()},[]);const B=t=>{C(t),j.current&&clearTimeout(j.current),j.current=setTimeout(()=>{p(t,f)},500)},D=t=>{F(t),p(g,t)},E=async(t,o)=>{v(t);try{const a=new FormData;a.append("action","warehouse_update_order_status"),a.append("nonce",h.updateNonce),a.append("order_id",String(t)),a.append("status",o);const s=await(await fetch(h.ajaxUrl,{method:"POST",body:a})).json();s.success?(b(y=>y.map(c=>c.id===t?{...c,status:s.data.new_status,status_name:s.data.new_status_name}:c)),i({show:!0,message:`Order #${t} status updated to ${s.data.new_status_name}`}),setTimeout(()=>i(null),3e3)):(i({show:!0,message:s.data?.message||"Failed to update",error:!0}),setTimeout(()=>i(null),4e3))}catch{i({show:!0,message:"Network error",error:!0}),setTimeout(()=>i(null),4e3)}finally{v(null)}};return e.jsx("div",{className:"page-container",children:e.jsxs("div",{className:"page-content",style:{paddingTop:"120px"},children:[e.jsx(k,{children:u?.show&&e.jsx(n.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"fixed bottom-6 right-6 z-50 w-full max-w-sm",children:e.jsxs(G,{variant:u.error?"destructive":"default",children:[u.error?e.jsx("svg",{className:"h-4 w-4 text-red-600 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}):e.jsx("svg",{className:"h-4 w-4 text-green-600 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{children:[e.jsx(H,{children:u.error?"Error":"Success"}),e.jsx(I,{children:u.message})]})]})})}),e.jsxs(n.div,{className:"mb-8 text-center",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},children:[e.jsx("h1",{className:"text-4xl font-bold mb-2",children:e.jsx(R,{animationSpeed:4,children:"Orders Management"})}),e.jsx("p",{className:"text-gray-500",children:"View and manage all dealer orders"})]}),e.jsxs(n.div,{className:"flex gap-4 justify-center items-center",style:{marginBottom:"24px"},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:[e.jsx(M,{type:"text",placeholder:"Search by order ID, customer...",value:g,onChange:t=>B(t.target.value),className:"max-w-xs w-full !rounded-full"}),e.jsxs("select",{value:f,onChange:t=>D(t.target.value),className:"h-10 text-sm border border-gray-200 rounded-full bg-white focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent",style:{padding:"0 15px"},children:[e.jsx("option",{value:"all",children:"All Statuses"}),Object.entries(w).map(([t,o])=>e.jsx("option",{value:t.replace("wc-",""),children:o},t))]}),e.jsx(U,{onClick:()=>p(g,f),children:"Refresh"})]}),O?e.jsxs(n.div,{className:"text-center py-16",initial:{opacity:0},animate:{opacity:1},children:[e.jsx("div",{className:"inline-block w-8 h-8 border-2 border-gray-300 border-t-gray-900 rounded-full animate-spin mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Loading orders..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(n.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white overflow-hidden",children:e.jsxs(P,{children:[e.jsx($,{children:e.jsxs(z,{children:[e.jsx(l,{children:"Order"}),e.jsx(l,{children:"Date"}),e.jsx(l,{children:"Customer"}),e.jsx(l,{children:"Items"}),e.jsx(l,{className:"text-right",children:"Total"}),e.jsx(l,{children:"Status"})]})}),e.jsx(W,{children:e.jsx(k,{children:x.map((t,o)=>e.jsxs(n.tr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{delay:o*.02},className:"border-b border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx(d,{className:"font-medium",children:e.jsxs("a",{href:`/my-account/view-order/${t.id}/`,className:"text-blue-600 hover:text-blue-800 hover:underline",children:["#",t.id]})}),e.jsx(d,{className:"text-gray-600",children:t.date}),e.jsxs(d,{children:[e.jsx("div",{className:"text-gray-900",children:t.customer}),e.jsx("div",{className:"text-gray-500 text-xs",children:t.email})]}),e.jsxs(d,{className:"text-gray-600",children:[t.items_count," item",t.items_count!==1?"s":""]}),e.jsxs(d,{className:"text-right font-medium text-gray-900",children:["$",parseFloat(t.total).toFixed(2)]}),e.jsx(d,{children:e.jsx("select",{value:t.status,onChange:a=>E(t.id,a.target.value),disabled:A===t.id,className:"h-10 text-sm border border-gray-200 rounded-full bg-white focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent",style:{padding:"0 15px",...(()=>{const m=(V[t.status]||"background:#f3f4f6;color:#6b7280;").split(";").filter(Boolean),s={};return m.forEach(y=>{const[c,S]=y.split(":");c&&S&&(s[c.trim()]=S.trim())}),s})()},children:Object.entries(w).map(([a,m])=>e.jsx("option",{value:a.replace("wc-",""),children:m},a))})})]},t.id))})})]})}),x.length===0&&e.jsx(n.div,{className:"text-center py-12",initial:{opacity:0},animate:{opacity:1},children:e.jsx("p",{className:"text-gray-500",children:"No orders found"})}),e.jsx(n.div,{className:"mt-6 text-center",initial:{opacity:0},animate:{opacity:1},children:e.jsxs("p",{className:"text-sm text-gray-400",children:["Showing ",x.length," order",x.length!==1?"s":""]})})]})]})})}const T=document.getElementById("warehouse-orders-root");T&&L.createRoot(T).render(e.jsx(r.StrictMode,{children:e.jsx(q,{})}));
