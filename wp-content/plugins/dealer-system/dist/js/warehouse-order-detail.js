import{c as B,j as e,r as m,m as i}from"./chunks/index-ClKf2CbM.js";import{G as D}from"./chunks/GradientText-BvkcKc4C.js";import{B as C}from"./chunks/Button-zSFrK51C.js";import{T as E,a as F,b as A,c as x,d as I,e as p}from"./chunks/Table-LW9oDM4-.js";import{A as L,a as U,b as M}from"./chunks/Alert-B5GFDb8d.js";import{A as _}from"./chunks/index-CWUfAGMP.js";const R={pending:"background:#fef3c7;color:#d97706;",processing:"background:#dbeafe;color:#2563eb;","on-hold":"background:#ffedd5;color:#ea580c;",completed:"background:#dcfce7;color:#16a34a;",cancelled:"background:#fee2e2;color:#dc2626;",refunded:"background:#f3f4f6;color:#6b7280;",failed:"background:#fee2e2;color:#dc2626;"},G={stock_order:"Stock Order",daily_order:"Daily Order",vor_order:"VOR Order"};function W(){const o=window.warehouseOrderDetail||{ajaxUrl:"",nonce:"",updateNonce:"",orderId:0,ordersPageUrl:"/warehouse-orders/"},[a,g]=m.useState(null),[v,w]=m.useState({}),[k,y]=m.useState(!0),[S,f]=m.useState(!1),[h,d]=m.useState(null),O=async()=>{y(!0);try{const r=new FormData;r.append("action","warehouse_get_order_detail"),r.append("nonce",o.nonce),r.append("order_id",String(o.orderId));const n=await(await fetch(o.ajaxUrl,{method:"POST",body:r})).json();n.success?(g(n.data.order),w(n.data.statuses)):d({show:!0,message:n.data?.message||"Failed to load order",error:!0})}catch(r){console.error("Failed to fetch order:",r),d({show:!0,message:"Network error",error:!0})}finally{y(!1)}};m.useEffect(()=>{o.orderId&&O()},[]);const T=async r=>{if(a){f(!0);try{const s=new FormData;s.append("action","warehouse_update_order_status"),s.append("nonce",o.updateNonce),s.append("order_id",String(a.id)),s.append("status",r);const l=await(await fetch(o.ajaxUrl,{method:"POST",body:s})).json();l.success?(g(c=>c?{...c,status:l.data.new_status,status_name:l.data.new_status_name}:null),d({show:!0,message:`Status updated to ${l.data.new_status_name}`}),setTimeout(()=>d(null),3e3)):(d({show:!0,message:l.data?.message||"Failed to update",error:!0}),setTimeout(()=>d(null),4e3))}catch{d({show:!0,message:"Network error",error:!0}),setTimeout(()=>d(null),4e3)}finally{f(!1)}}},P=r=>{const n=(R[r]||"background:#f3f4f6;color:#6b7280;").split(";").filter(Boolean),l={};return n.forEach(c=>{const[j,b]=c.split(":");j&&b&&(l[j.trim()]=b.trim())}),l},t=({label:r,value:s})=>e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:r}),e.jsx("p",{className:"font-medium text-gray-900",children:s||"-"})]}),u=({title:r,name:s,email:n,mobile:l,phone:c})=>!s&&!n&&!l&&!c?null:e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-100",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3 border-b pb-2",children:r}),e.jsxs("div",{className:"space-y-2 text-sm",children:[s&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Name:"})," ",e.jsx("span",{className:"text-gray-900",children:s})]}),n&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Email:"})," ",e.jsx("span",{className:"text-gray-900",children:n})]}),l&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Mobile:"})," ",e.jsx("span",{className:"text-gray-900",children:l})]}),c&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Phone:"})," ",e.jsx("span",{className:"text-gray-900",children:c})]})]})]});return e.jsx("div",{className:"page-container",children:e.jsxs("div",{className:"page-content",style:{paddingTop:"120px"},children:[e.jsx(_,{children:h?.show&&e.jsx(i.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"fixed bottom-6 right-6 z-50 w-full max-w-sm",children:e.jsxs(L,{variant:h.error?"destructive":"default",children:[h.error?e.jsx("svg",{className:"h-4 w-4 text-red-600 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}):e.jsx("svg",{className:"h-4 w-4 text-green-600 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{children:[e.jsx(U,{children:h.error?"Error":"Success"}),e.jsx(M,{children:h.message})]})]})})}),e.jsx(i.div,{className:"mb-6",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:e.jsxs("a",{href:o.ordersPageUrl,className:"inline-flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back to Orders"]})}),k?e.jsxs(i.div,{className:"text-center py-16",initial:{opacity:0},animate:{opacity:1},children:[e.jsx("div",{className:"inline-block w-8 h-8 border-2 border-gray-300 border-t-gray-900 rounded-full animate-spin mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Loading order details..."})]}):a?e.jsxs(e.Fragment,{children:[e.jsx(i.div,{className:"mb-8",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold mb-2",children:e.jsxs(D,{animationSpeed:4,children:["Order #",a.id]})}),e.jsx("p",{className:"text-gray-500",children:a.date})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("select",{value:a.status,onChange:r=>T(r.target.value),disabled:S,className:"h-10 px-4 py-2 text-sm border border-gray-200 rounded-full bg-white focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent font-medium",style:P(a.status),children:Object.entries(v).map(([r,s])=>e.jsx("option",{value:r.replace("wc-",""),children:s},r))})})]})}),e.jsxs(i.div,{className:"mb-8 bg-gray-50 rounded-xl p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Customer Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(t,{label:"Name",value:a.customer}),e.jsx(t,{label:"Email",value:a.email}),e.jsx(t,{label:"Phone",value:a.phone})]})]}),a.dealer_info&&e.jsxs(i.div,{className:"mb-8 bg-gray-50 rounded-xl p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.15},children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Dealer Information"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-3",children:"Business Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(t,{label:"Dealer Group",value:a.dealer_info.dealer_group}),e.jsx(t,{label:"Company Name",value:a.dealer_info.dealer_company_name}),e.jsx(t,{label:"Business Name",value:a.dealer_info.business_name}),e.jsx(t,{label:"Delivery Address",value:a.dealer_info.delivery_address_full}),e.jsx(t,{label:"Suburb",value:a.dealer_info.suburb}),e.jsx(t,{label:"State",value:a.dealer_info.state}),e.jsx(t,{label:"Post Code",value:a.dealer_info.post_code})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-3",children:"Operating Hours"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(t,{label:"Monday - Friday",value:a.dealer_info.operating_hours_weekday}),e.jsx(t,{label:"Saturday",value:a.dealer_info.operating_hours_saturday})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-3",children:"Contacts"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx(u,{title:"Accounts Payable",name:a.dealer_info.accounts_payable,email:a.dealer_info.accounts_payable_email,mobile:a.dealer_info.accounts_payable_mobile,phone:a.dealer_info.accounts_payable_phone}),e.jsx(u,{title:"Parts Manager",name:a.dealer_info.parts_manager,email:a.dealer_info.parts_manager_email,mobile:a.dealer_info.parts_manager_mobile,phone:a.dealer_info.parts_manager_phone}),e.jsx(u,{title:"Parts Interpreter (Front)",name:a.dealer_info.parts_interpreter_front,email:a.dealer_info.parts_interpreter_front_email,mobile:a.dealer_info.parts_interpreter_front_mobile,phone:a.dealer_info.parts_interpreter_front_phone}),e.jsx(u,{title:"Parts Interpreter (Back)",name:a.dealer_info.parts_interpreter_back,email:a.dealer_info.parts_interpreter_back_email,mobile:a.dealer_info.parts_interpreter_back_mobile,phone:a.dealer_info.parts_interpreter_back_phone}),e.jsx(u,{title:"Parts Group",name:a.dealer_info.parts_group,email:a.dealer_info.parts_group_email,mobile:a.dealer_info.parts_group_mobile,phone:a.dealer_info.parts_group_phone})]})]})]}),e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Order Items"}),e.jsx("div",{className:"bg-white rounded-xl overflow-hidden border border-gray-100",children:e.jsxs(E,{children:[e.jsx(F,{children:e.jsxs(A,{children:[e.jsx(x,{children:"Product"}),e.jsx(x,{children:"SKU"}),e.jsx(x,{children:"Type"}),e.jsx(x,{className:"text-center",children:"Qty"}),e.jsx(x,{className:"text-right",children:"Price"}),e.jsx(x,{className:"text-right",children:"Total"})]})}),e.jsx(I,{children:e.jsx(_,{children:a.items.map((r,s)=>e.jsxs(i.tr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{delay:s*.02},className:"border-b border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx(p,{className:"font-medium text-gray-900",children:r.name}),e.jsx(p,{className:"text-gray-600 font-mono text-sm",children:r.sku||"-"}),e.jsx(p,{children:e.jsx("span",{className:"inline-block px-2 py-1 text-xs font-medium bg-gray-100 text-gray-700 rounded",children:G[r.order_type]||r.order_type||"Stock Order"})}),e.jsx(p,{className:"text-center text-gray-900",children:r.quantity}),e.jsxs(p,{className:"text-right text-gray-600",children:["$",r.price.toFixed(2)]}),e.jsxs(p,{className:"text-right font-medium text-gray-900",children:["$",r.total.toFixed(2)]})]},s))})})]})})]}),e.jsx(i.div,{className:"flex justify-end mb-8",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsxs("div",{className:"bg-gray-900 text-white rounded-xl px-8 py-4",children:[e.jsx("span",{className:"text-gray-400 mr-4",children:"Order Total"}),e.jsxs("span",{className:"text-2xl font-bold",children:["$",parseFloat(a.total).toFixed(2)]})]})}),a.notes&&e.jsxs(i.div,{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:[e.jsx("h2",{className:"text-lg font-semibold mb-2 text-yellow-800",children:"Order Notes"}),e.jsx("p",{className:"text-yellow-700 whitespace-pre-wrap",children:a.notes})]})]}):e.jsxs(i.div,{className:"text-center py-16",initial:{opacity:0},animate:{opacity:1},children:[e.jsx("p",{className:"text-gray-500",children:"Order not found"}),e.jsx(C,{onClick:()=>window.location.href=o.ordersPageUrl,className:"mt-4",children:"Back to Orders"})]})]})})}const N=document.getElementById("warehouse-order-detail-root");N&&B.createRoot(N).render(e.jsx(m.StrictMode,{children:e.jsx(W,{})}));
