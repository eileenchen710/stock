import{c as T,j as e,r as d,m as a}from"./chunks/index-ClKf2CbM.js";import{G as B}from"./chunks/GradientText-BvkcKc4C.js";import{B as E}from"./chunks/Button-zSFrK51C.js";import{A as f,T as L,a as P,b as D,c,d as F,e as x}from"./chunks/Table-CJsp_9j5.js";import{A as U,a as A,b as C}from"./chunks/Alert-B5GFDb8d.js";const R={pending:"background:#fef3c7;color:#d97706;",processing:"background:#dbeafe;color:#2563eb;","on-hold":"background:#ffedd5;color:#ea580c;",completed:"background:#dcfce7;color:#16a34a;",cancelled:"background:#fee2e2;color:#dc2626;",refunded:"background:#f3f4f6;color:#6b7280;",failed:"background:#fee2e2;color:#dc2626;"},I={stock_order:"Stock Order",daily_order:"Daily Order",vor_order:"VOR Order"};function M(){const o=window.warehouseOrderDetail||{ajaxUrl:"",nonce:"",updateNonce:"",orderId:0,ordersPageUrl:"/warehouse-orders/"},[s,u]=d.useState(null),[N,w]=d.useState({}),[v,p]=d.useState(!0),[k,y]=d.useState(!1),[m,n]=d.useState(null),S=async()=>{p(!0);try{const t=new FormData;t.append("action","warehouse_get_order_detail"),t.append("nonce",o.nonce),t.append("order_id",String(o.orderId));const l=await(await fetch(o.ajaxUrl,{method:"POST",body:t})).json();l.success?(u(l.data.order),w(l.data.statuses)):n({show:!0,message:l.data?.message||"Failed to load order",error:!0})}catch(t){console.error("Failed to fetch order:",t),n({show:!0,message:"Network error",error:!0})}finally{p(!1)}};d.useEffect(()=>{o.orderId&&S()},[]);const O=async t=>{if(s){y(!0);try{const r=new FormData;r.append("action","warehouse_update_order_status"),r.append("nonce",o.updateNonce),r.append("order_id",String(s.id)),r.append("status",t);const i=await(await fetch(o.ajaxUrl,{method:"POST",body:r})).json();i.success?(u(h=>h?{...h,status:i.data.new_status,status_name:i.data.new_status_name}:null),n({show:!0,message:`Status updated to ${i.data.new_status_name}`}),setTimeout(()=>n(null),3e3)):(n({show:!0,message:i.data?.message||"Failed to update",error:!0}),setTimeout(()=>n(null),4e3))}catch{n({show:!0,message:"Network error",error:!0}),setTimeout(()=>n(null),4e3)}finally{y(!1)}}},_=t=>{const l=(R[t]||"background:#f3f4f6;color:#6b7280;").split(";").filter(Boolean),i={};return l.forEach(h=>{const[g,j]=h.split(":");g&&j&&(i[g.trim()]=j.trim())}),i};return e.jsx("div",{className:"page-container",children:e.jsxs("div",{className:"page-content",style:{paddingTop:"120px"},children:[e.jsx(f,{children:m?.show&&e.jsx(a.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"fixed bottom-6 right-6 z-50 w-full max-w-sm",children:e.jsxs(U,{variant:m.error?"destructive":"default",children:[m.error?e.jsx("svg",{className:"h-4 w-4 text-red-600 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}):e.jsx("svg",{className:"h-4 w-4 text-green-600 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{children:[e.jsx(A,{children:m.error?"Error":"Success"}),e.jsx(C,{children:m.message})]})]})})}),e.jsx(a.div,{className:"mb-6",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:e.jsxs("a",{href:o.ordersPageUrl,className:"inline-flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back to Orders"]})}),v?e.jsxs(a.div,{className:"text-center py-16",initial:{opacity:0},animate:{opacity:1},children:[e.jsx("div",{className:"inline-block w-8 h-8 border-2 border-gray-300 border-t-gray-900 rounded-full animate-spin mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Loading order details..."})]}):s?e.jsxs(e.Fragment,{children:[e.jsx(a.div,{className:"mb-8",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold mb-2",children:e.jsxs(B,{animationSpeed:4,children:["Order #",s.id]})}),e.jsx("p",{className:"text-gray-500",children:s.date})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("select",{value:s.status,onChange:t=>O(t.target.value),disabled:k,className:"h-10 px-4 py-2 text-sm border border-gray-200 rounded-full bg-white focus:outline-none focus:ring-2 focus:ring-black focus:border-transparent font-medium",style:_(s.status),children:Object.entries(N).map(([t,r])=>e.jsx("option",{value:t.replace("wc-",""),children:r},t))})})]})}),e.jsxs(a.div,{className:"mb-8 bg-gray-50 rounded-xl p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Customer Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Name"}),e.jsx("p",{className:"font-medium text-gray-900",children:s.customer})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Email"}),e.jsx("p",{className:"font-medium text-gray-900",children:s.email||"-"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Phone"}),e.jsx("p",{className:"font-medium text-gray-900",children:s.phone||"-"})]})]})]}),e.jsxs(a.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Order Items"}),e.jsx("div",{className:"bg-white rounded-xl overflow-hidden border border-gray-100",children:e.jsxs(L,{children:[e.jsx(P,{children:e.jsxs(D,{children:[e.jsx(c,{children:"Product"}),e.jsx(c,{children:"SKU"}),e.jsx(c,{children:"Type"}),e.jsx(c,{className:"text-center",children:"Qty"}),e.jsx(c,{className:"text-right",children:"Price"}),e.jsx(c,{className:"text-right",children:"Total"})]})}),e.jsx(F,{children:e.jsx(f,{children:s.items.map((t,r)=>e.jsxs(a.tr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{delay:r*.02},className:"border-b border-gray-100 hover:bg-gray-50 transition-colors",children:[e.jsx(x,{className:"font-medium text-gray-900",children:t.name}),e.jsx(x,{className:"text-gray-600 font-mono text-sm",children:t.sku||"-"}),e.jsx(x,{children:e.jsx("span",{className:"inline-block px-2 py-1 text-xs font-medium bg-gray-100 text-gray-700 rounded",children:I[t.order_type]||t.order_type||"Stock Order"})}),e.jsx(x,{className:"text-center text-gray-900",children:t.quantity}),e.jsxs(x,{className:"text-right text-gray-600",children:["$",t.price.toFixed(2)]}),e.jsxs(x,{className:"text-right font-medium text-gray-900",children:["$",t.total.toFixed(2)]})]},r))})})]})})]}),e.jsx(a.div,{className:"flex justify-end mb-8",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsxs("div",{className:"bg-gray-900 text-white rounded-xl px-8 py-4",children:[e.jsx("span",{className:"text-gray-400 mr-4",children:"Order Total"}),e.jsxs("span",{className:"text-2xl font-bold",children:["$",parseFloat(s.total).toFixed(2)]})]})}),s.notes&&e.jsxs(a.div,{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},children:[e.jsx("h2",{className:"text-lg font-semibold mb-2 text-yellow-800",children:"Order Notes"}),e.jsx("p",{className:"text-yellow-700 whitespace-pre-wrap",children:s.notes})]})]}):e.jsxs(a.div,{className:"text-center py-16",initial:{opacity:0},animate:{opacity:1},children:[e.jsx("p",{className:"text-gray-500",children:"Order not found"}),e.jsx(E,{onClick:()=>window.location.href=o.ordersPageUrl,className:"mt-4",children:"Back to Orders"})]})]})})}const b=document.getElementById("warehouse-order-detail-root");b&&T.createRoot(b).render(e.jsx(d.StrictMode,{children:e.jsx(M,{})}));
